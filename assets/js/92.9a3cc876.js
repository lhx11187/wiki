(window.webpackJsonp=window.webpackJsonp||[]).push([[92],{448:function(s,a,t){"use strict";t.r(a);var n=t(42),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"subversion"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#subversion"}},[s._v("#")]),s._v(" subversion")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://blog.csdn.net/atsoar/article/details/80460440",target:"_blank",rel:"noopener noreferrer"}},[s._v("SVN快速上手"),t("OutboundLink")],1)])]),s._v(" "),t("h2",{attrs:{id:"安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -aq subversion\nyum -y "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" subversion\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/yum.repos.d/wandisco-svn.repo\nyum --disablerepo"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*"')]),s._v(" --enablerepo"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"WandiscoSVN"')]),s._v(" info subversion\n")])])]),t("p",[s._v("repo")]),s._v(" "),t("div",{staticClass:"language-ini extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[WandiscoSVN]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("Wandisco SVN Repo")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("baseurl")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("http://opensource.wandisco.com/centos/7/svn-1.9/RPMS/x86_64/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("enabled")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("gpgcheck")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("0")]),s._v("\n")])])]),t("p",[t("strong",[s._v("数据权限")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 存储项目")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /data/svndata\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 存储用户、密码以及权限")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /data/svnpasswd\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动SVN服务，指定服务的SVN根目录")]),s._v("\nsvnserve -d -r /data/svndata/\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 建立项目版本库 fsfs bdb")]),s._v("\nsvnadmin create --fs-type fsfs /data/svndata/sadoc\n")])])]),t("p",[s._v("项目配置文件 conf/svnserve.conf")]),s._v(" "),t("div",{staticClass:"language-ini extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 控制非鉴权用户访问版本库的权限")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("anon-access")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" none")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 控制鉴权用户访问版本库的权限")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("auth-access")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" write")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定用户名口令文件名")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("password-db")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" /data/svnpasswd/passwd")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定权限配置文件名")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("authz-db")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" /data/svnpasswd/authz")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定版本库的认证域，即在登录时提示的认证域名称")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("realm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" somnus")]),s._v("\n")])])]),t("p",[t("strong",[s._v("访问权限")])]),s._v(" "),t("p",[s._v("passwd")]),s._v(" "),t("div",{staticClass:"language-ini extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[users]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("username")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" password")]),s._v("\n")])])]),t("p",[s._v("authz")]),s._v(" "),t("div",{staticClass:"language-ini extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[groups]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("sadocgroup")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" aitemi,cjch")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[sadoc:/]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("aitemi")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("rw")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("@sadocgroup")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("rw")]),s._v("\n")])])]),t("h2",{attrs:{id:"apache"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#apache"}},[s._v("#")]),s._v(" Apache")]),s._v(" "),t("p",[t("strong",[s._v("安装 httpd, mod_dav_svn")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y httpd mod_dav_svn\nhttpd -v\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" / -name mod_dav_svn.so\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" / -name mod_authz_svn.so\n")])])]),t("p",[s._v("vi /etc/httpd/conf.d/subversion.conf")]),s._v(" "),t("div",{staticClass:"language-xml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[s._v('IncludeOptional /etc/httpd/conf.modules.d/00-base.conf\nIncludeOptional /etc/httpd/conf.modules.d/00-dav.conf\nLoadModule dav_svn_module     modules/mod_dav_svn.so\nLoadModule authz_svn_module   modules/mod_authz_svn.so\nLoadModule dontdothat_module  modules/mod_dontdothat.so\n<Location /svn>\n    DAV svn\n    SVNParentPath /var/www/svn\n    AuthType Basic\n    AuthName "Authorization SVN"\n    AuthzSVNAccessFile /var/www/svn/authz\n    AuthUserFile /var/www/svn/passwd\n    Require valid-user\n'),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("Location")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])])]),t("p",[t("strong",[s._v("配置apache对SVN目录权限")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R apache:apache /home/data/svn/mes_v1\n")])])]),t("h2",{attrs:{id:"迁移"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#迁移"}},[s._v("#")]),s._v(" 迁移")]),s._v(" "),t("p",[t("strong",[s._v("备份")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 全量备份")]),s._v("\nsvnadmin dump /path/to/repository "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("gzip")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /path/to/repository-backup.gz\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 增量备份")]),s._v("\nsvnadmin dump /path/to/repository –r sour_version:des_version --incremental "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" sour-des.date\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 冷备份")]),s._v("\nsvnadmin hotcopy /path/to/repository  /path/to/repository-backup.date\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 热备份")]),s._v("\nsvnadmin hotcopy /path/to/repository  /path/to/repository-backup.date –clean-logs\n")])])]),t("p",[t("strong",[s._v("恢复")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 建立新的svn存储库")]),s._v("\nsvnadmin create /path/to/new_repository\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 导入没压缩数据")]),s._v("\nsvnadmin load /path/to/new_repository "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" /path/to/repository-backup.date\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 导入被压缩数据")]),s._v("\nzcat /path/to/repository-backup.date "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" svnadmin load /path/to/new_repository\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# hotcopy")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 恢复")]),s._v("\nsvnadmin hotcopy /path/to/repository-backup.date /path/to/new_repository\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 直接覆盖")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" /path/to/repository-backup.date /path/to/new_repository\n")])])]),t("h2",{attrs:{id:"钩子"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#钩子"}},[s._v("#")]),s._v(" 钩子")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://juejin.im/post/6844903747911417864",target:"_blank",rel:"noopener noreferrer"}},[s._v("SVN Hooks的介绍及使用"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=e.exports}}]);