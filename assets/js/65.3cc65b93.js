(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{422:function(t,s,a){"use strict";a.r(s);var n=a(42),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"frp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#frp"}},[t._v("#")]),t._v(" frp")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/fatedier/frp/issues/176",target:"_blank",rel:"noopener noreferrer"}},[t._v("frp怎样开机启动和后台运行"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"nobody"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nobody"}},[t._v("#")]),t._v(" nobody")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" frp\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" log\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("chown")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("99")]),t._v(":99 log\n")])])]),a("h2",{attrs:{id:"frps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#frps"}},[t._v("#")]),t._v(" frps")]),t._v(" "),a("div",{staticClass:"language-ini extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[a("span",{pre:!0,attrs:{class:"token selector"}},[t._v("[common]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("bind_addr")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" 0.0.0.0")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("bind_port")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" 17000")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("vhost_http_port")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" 80")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("token")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" token")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("dashboard_addr")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" 0.0.0.0")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("dashboard_port")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" 17500")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("dashboard_user")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" admin")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("dashboard_pwd")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" token")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("log_file")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" /root/frp/log/frps.log")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("log_level")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" info")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("log_max_days")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" 7")]),t._v("\n")])])]),a("h2",{attrs:{id:"frpc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#frpc"}},[t._v("#")]),t._v(" frpc")]),t._v(" "),a("div",{staticClass:"language-ini extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[a("span",{pre:!0,attrs:{class:"token selector"}},[t._v("[common]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("token")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" token")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("user")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" cg")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("server_addr")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" example.com")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("server_port")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" 17000")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("log_file")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" /root/frp/log/frpc.log")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("log_level")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" info")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("log_max_days")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" 3")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("login_fail_exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" true")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token selector"}},[t._v("[mstsc]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" tcp")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("local_ip")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" 127.0.0.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("local_port")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" 3389")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("remote_port")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" 20030")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("use_encryption")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("use_compression")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" false")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token selector"}},[t._v("[web]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" http")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("local_ip")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" 127.0.0.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("local_port")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" 80")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("custom_domains")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" test.lhcdn.com")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("use_encryption")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("use_compression")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" true")]),t._v("\n")])])]),a("h2",{attrs:{id:"daemon"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#daemon"}},[t._v("#")]),t._v(" daemon")]),t._v(" "),a("h3",{attrs:{id:"nohup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nohup"}},[t._v("#")]),t._v(" nohup")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./frps -c ./frps.ini "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&>")]),t._v(" /dev/null\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./frps -c ./frps.ini "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/dev/null "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),a("h3",{attrs:{id:"systemd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#systemd"}},[t._v("#")]),t._v(" systemd")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" /usr/lib/systemd/system/frps.service\nsystemctl daemon-reload\n")])])]),a("p",[t._v("配置文件")]),t._v(" "),a("div",{staticClass:"language-ini extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[a("span",{pre:!0,attrs:{class:"token selector"}},[t._v("[Unit]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("Description")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("frps daemon")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("After")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("syslog.target network.target")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("Wants")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("network.target")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token selector"}},[t._v("[Service]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("Type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("simple")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("User")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("nobody")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ExecStart")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("/root/frp/frps -c /root/frp/frps.ini")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("Restart")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("on-failure")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("RestartSec")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("5s")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# CapabilityBoundingSet=CAP_NET_BIND_SERVICE")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("AmbientCapabilities")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("CAP_NET_BIND_SERVICE")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token selector"}},[t._v("[Install]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("WantedBy")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("multi-user.target")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);